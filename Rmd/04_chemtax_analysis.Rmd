---
title: "Chemtax Analysis"
author: "Anna Finch"
date: '2022-06-24'
output: html_document
---

# 1.0 ---- Summary of Document ----



# 2.0 ---- Setup ----

## 2.1 Load libraries
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
librarian::shelf(
  librarian, conflicted, ggplot2, tibble, tidyr, readr, purrr, dplyr, stringr,
  forcats, lubridate, glue, fs, magrittr, here,
  # broom # optional
  
  rlang, cli,
  
  # additional
  rstatix, readxl, ggtext,
  cowplot
  )

conflicts_prefer(
  dplyr::filter(), 
  dplyr::select()
    )

source(here("scripts", "misc_functions.R"))
```


## 2.2 File Paths for CHEMTAX Data and Setup Variables

5 datasets includes:
- Seasonal clusters for each run of CHEMTAX
  - Winter
  - Spring
  - Summer
  - Autumn
  
- Overall averages for all clusters

```{r file-paths-chemtax-data, include=FALSE}
# set save directory
dir_plt_save  <- here("data", "plots", "chemtax_analysis")
dir_data_save <- here("data", "processed", "chemtax_analysis")

dir_create(here(dir_plt_save, "boxplots"))

# set season names and order
szn <- c("Winter", "Spring", "Summer", "Autumn")

# ---- CHEMTAX file paths
file_chem <-
  here("data", "raw") %>%
  dir_ls(
    recurse = TRUE,
    regexp  = "mbonpig.*\\.xls$") %>% 
  str_sort() %>%
  tibble(files = .) %T>% print()


# ---- load metadata
meta_data <-
  here("data", "processed", "load_data", "combined_pig_dat.csv") %>%
  read_csv(show_col_types = FALSE) %>%
  select(hplc_gsfc_id:lat) %>%
  mutate(season = fct(season, szn)) %>%
  filter(
    str_detect(name_of_water_body, "Florida Keys")
    # sample was missed in orignial analysis
    & !str_detect(sample, "WS18008_43")
    ) %T>% print()

# ---- load average seasonal CHEMTAX data
# *not used beyond first plot*
# average each season
cmtx_all <-
  file_chem %>%
  filter(str_detect(files, "cluster")) %>%
  mutate(
    filename = basename(files) %>% tools::file_path_sans_ext(),
    ranges   = c("D177:N178", "D273:N274", "D241:N242", "D305:N306"),
    cluster  = str_extract(filename, "\\d$"),
    season   = fct_inorder(szn),
    data     = map2(
      files, ranges,
      ~ read_xls(
        path  = .x,
        sheet = "Notes",
        range = .y,
        .name_repair = janitor::make_clean_names
      )
    )
  ) %>%
  select(-c(1:ranges)) %>%
  unnest(data) %T>% print()


# ---- load merged cluster CHEMTAX data 
cmtx_avgs_raw <-
  pull(file_chem, files)[5] %>%
  readxl::read_xls(
    .,
    sheet = "Avgs",
    .name_repair = janitor::make_clean_names
  ) %>%
  filter(!str_detect(sample_id, "WS19210-59")) %T>% print()


# ---- phyto full names
phyto_name <-
  tibble(
    names = c(
      "Chlorophytes", "Cryptophytes", "Cyanobacteria 2",
      "Cyanobacteria 4", "Diatoms 1", "Diatoms 2",
      "Dinoflagellates", "Haptophytes 6", "Haptophytes 8",
      "Prasinophytes"
    )
  ) %>%
  bind_cols(shrt = names(cmtx_all)[-c(1:3)]) %>%
    
  # add rows for combined name
  add_row(
    shrt  = c("cyano", "diat", "hapt"),
    names = c("Cyanobacteria", "Diatom", "Haptophyte")
  )
```


## 2.3 Line and Box Plot Plotting Functions 

Default Line Plot and Box Plots

```{r functions-line-box}
# ---- line plot
line_plt <- function(.dat, .var, .title) {
    
    # set limits
    ylims <- c(0, max(.dat[[.var]]) * 1.05)
    brake <- pretty(ylims, 5)
    
    # plot
    .dat %>%
    ggplot(aes(x = season, y = .data[[.var]])) +
    geom_point(size = 2) +
    geom_line(group = 1, 
              linewidth  = 1) +
    
    # labels
    labs(
     title = glue("Average Concentration per Season of {.title}"),
     x     = "Season",
     y     = "Concentration of Chlorophyll-a (mg m<sup>-3</sup>)"
     ) +
     
    # scale setup   
    scale_y_continuous(
      breaks = brake,
      limits = ylims,
      expand = expansion(mult = 0)
      ) +
    
    # theme setup   
    theme_bw(base_family = "serif") +
    theme(
      panel.grid.major.y = element_blank(),
      panel.grid.minor.y = element_blank(),
      plot.title         = element_text(size = 15),
      axis.ticks.length  = unit(-0.05, "in"),
      axis.text.y        = element_text(margin = unit(c(0.3,0.3,0.3,0.3), "cm")),
      axis.title.y       = element_markdown(size = 10),
      axis.text.x        = element_text(margin = unit(c(0.3,0.3,0.3,0.3), "cm")),
      axis.ticks.x       = element_blank(),
      legend.background  = element_rect(color = "black", fill = "white")
    )
}

# ---- box plot
box_plt <- function(.dat, .var, .title) {
    
    # limits for plot
    ylims <-  c(0, quantile(.dat[[.var]], 0.99))
    brake <- pretty(ylims, 6)

    # plotting
    .dat %>%
    ggplot() +
    geom_boxplot(
      aes(
        x = season, 
        y = .data[[.var]]
        ),
      outlier.shape = NA) +
    geom_jitter(
        aes(
          x = season, 
          y = .data[[.var]], 
          color = year
          ),
        width = 0.4,
        size = 0.5
        ) +
    
    # labels
    labs(
      title = glue("Concentration of {.title} per Season "),
      x     = "Season",
      y     = "Concentration (mg m<sup>-3</sup>)",
      color = "Year") +

    # scale settings
    scale_color_binned(type = "viridis") +
    
    scale_y_continuous(
      breaks = brake,
      expand = expansion(mult = 0),
      limits = ylims,
      oob    = scales::squish
      ) +
    
    # theme settings
    theme_bw(base_family = "serif") +
    theme(
      panel.grid        = element_blank(),
      plot.title        = element_text(size = 15),
      axis.ticks.length = unit(-0.05, "in"),
      axis.text.y       = element_text(margin = unit(c(0.3,0.3,0.3,0.3), "cm")),
      axis.title.y      = element_markdown(size = 10),
      axis.text.x       = element_text(margin = unit(c(0.3,0.3,0.3,0.3), "cm")),
      axis.ticks.x      = element_blank(),
      legend.background = element_rect(color = "black", fill = "white")
    )
}
```


# 3.0 ---- Line Plot: Average Seasonal PFT vs Season ----

Not super useful

Average PFT in concentration of total chlorophyll-a (mg m^-3)

```{r line-plt}
cmtx_all %>%
  select(-rms) %>%
  pivot_longer(
    cols      = -c(1:2),
    names_to  = "phyto",
    values_to = "avg_conc"
  ) %>%
  group_by(phyto) %>%
  nest() %>%
  left_join(phyto_name, by = c("phyto" = "shrt")) %$%
  walk2(
    data, 
    names, 
    ~ line_plt(
      .dat = .x,
      .var = "avg_conc",
      .title = .y
    ) %>%
      print()
  )
```

# 4.0 ---- Box Plots ----

## 4.1 Load All Phytoplankton Concentrations

```{r load-comb-data}
# ---- join metadata and chemtax data
cmtx_avgs <-
  full_join(
    meta_data,
    cmtx_avgs_raw,
    by = join_by("sample" == "sample_id"),
    relationship = "many-to-many"
  )

# removing duplicates
cmtx_avgs_no_dupes <-
  cmtx_avgs %>%
  reframe(
    .by = c(date_time_utc, station, depth),
    pick(1:cluster_code),
    across(
      chloro:pras,
      \(x) mean(x, na.rm = TRUE)
    )
  ) %>%
  distinct(date_time_utc, station, depth, .keep_all = TRUE)

# ---- save chemtax data with metadata
# if (
#   !file_exists(here(dir_data_save, "chemtax_w_meta.csv"))
#   | !file_exists(here(dir_data_save, "chemtax_w_meta_rm_dup.csv"))
#   ) {
#   
#   cmtx_avgs <-
#     cmtx_avgs %>%
#     pivot_longer(
#       cols      = chloro:pras,
#       names_to  = "phyto",
#       values_to = "conc"
#     ) %>%
#     left_join(phyto_name, by = c("phyto" = "shrt"))
# 
#   save_csv(
#     .data          = cmtx_avgs,        
#     save_location  = dir_data_save,
#     save_name      = "chemtax_w_meta",
#     overwrite      = FALSE,
#     verbose        = TRUE,
#     time_stamp_fmt = NULL
#     )
# 
#   save_csv(
#     .data          = cmtx_avgs_no_dupes,        
#     save_location  = dir_data_save,
#     save_name      = "chemtax_w_meta_rm_dup",
#     overwrite      = FALSE,
#     verbose        = TRUE,
#     time_stamp_fmt = NULL
#     )
#   
# } else {
#   cli::cli_alert_info(c(
#     "Skipping saving of ",
#     "{.file chemtax_with_metadata.csv} ",
#     "because already exists!"
#   ))
# }

cmtx_avgs <-
  cmtx_avgs_no_dupes %>%
  pivot_longer(
    cols      = chloro:pras,
    names_to  = "phyto",
    values_to = "conc"
  ) %>%
  left_join(phyto_name, by = c("phyto" = "shrt"))

cmtx_avgs_w <- cmtx_avgs_no_dupes

rm(file_chem, meta_data, cmtx_avgs_raw, cmtx_avgs_no_dupes)
```

## 4.2 Box Plot: Individuals for Each PFT per Season

```{r boxplots, fig.height=15, fig.width=20}
# ---- avg season line plots
cmtx_avgs_plt <-
  cmtx_avgs %>%
  nest(.by = c(phyto, names)) %>%
  mutate(
    plt = map2(
      data,
      names,
      ~ box_plt(
        .dat   = .x,
        .var   = "conc",
        .title = .y
      )
    )
  )

cmtx_avgs_plt$plt

```

# 5.0 ---- PFT multi-plots ----


## 5.1 Box Plot: Larger Dynamic Range PFTs


```{r box-lg-dynm, fig.height=15, fig.width=20}
box_lg <-
  cmtx_avgs %>%
  filter(!phyto %in% c("chloro", "crypto", "diat1", "diat2", "dino", "pras")) %>%
  ggplot(
    aes(
      x    = season,
      y    = conc,
      fill = season
    )
  ) +
  geom_boxplot(outlier.shape = NA) +
  
  scale_y_continuous(
    expand = c(0, 0),
    limits = c(0, 0.2),
    oob    = scales::squish
  ) +
  labs(
    x = "Season",
    y = "Concentration of Chlorophyll-a (mg m<sup>-3</sup>)"
  ) +
  facet_wrap(facet = ~names, ncol = 2) +
  theme_classic() +
  theme(
    text            = element_text(family = "serif", size = 18),
    axis.text       = element_markdown(size = 10),
    axis.title.y    = element_markdown(size = 10),
    legend.position = "none"
  )

box_lg
```

## 5.2 Box Plot: Smaller Dynamic Ranged PFTs


```{r box-sm-dynm, fig.height=15, fig.width=20}
box_sm <-
  cmtx_avgs %>%
  filter(!phyto %in% c("cyano2", "chloro", "hapt6")) %>%
  ggplot(
    aes(
      x    = season,
      y    = conc,
      fill = season
      )
  ) +
  geom_boxplot(outlier.shape = NA) +
  scale_y_continuous(
    expand = c(0, 0),
    limits = c(0, 0.1),
    oob    = scales::squish
  ) +

  # labels
  labs(
    x = "Season",
    y = "Concentration of Chlorophyll-a (mg m<sup>-3</sup>)"
  ) +
  facet_wrap(facet = ~names, ncol = 3) +

  # theme
  theme_classic() +
  theme(
    text            = element_text(family = "serif", size = 18),
    axis.text       = element_text(size = 12),
    axis.title.y    = element_markdown(size = 10),
    legend.position = "none"
  )

box_sm
```

## 5.3 Save: Large and Small Range Boxplots

```{r save-plt}
# save arguments
sv_arg <-
  list(
    sv_loc    = here(dir_plt_save, "boxplots"),
    sv_nm     = str_c("cmtx_boxplot_", c("sm", "lg")),
    overwrite = FALSE
  ) %>%
  c(
    .,
    sm_exist = dir_ls(.$sv_loc, regexp = .$sv_nm[1]) %>% is_empty(),
    lg_exist = dir_ls(.$sv_loc, regexp = .$sv_nm[2]) %>% is_empty()
  )

# save larger dynamic range
if (sv_arg$lg_exist | sv_arg$overwrite) {
  save_plot(
    filename =
      here(
        sv_arg$sv_loc,
        glue(
          sv_arg$sv_nm[2],
          format(Sys.time(), "_%Y%m%d_%H%M%S"),
          ".jpeg"
        )
      ),
    plot        = box_lg,
    base_height = 6,
    base_width  = 10,
    dpi         = 600,
    units       = "in",
    device      = "jpeg"
  )
} else {
  cli::cli_alert_info(
    c(
      "Skipping saving of {.file cmtx_boxplot_lg} ",
      "because exists ",
      "and/or overwrite is set {.var FALSE}"
    )
  )
}


# save smaller dynamic range
if (sv_arg$sm_exist | sv_arg$overwrite) {
  save_plot(
    filename =
      here(
        sv_arg$sv_loc,
        glue(
          sv_arg$sv_nm[1],
          format(Sys.time(), "_%Y%m%d_%H%M%S"),
          ".jpeg"
        )
      ),
    plot        = box_sm,
    base_height = 6,
    base_width  = 10,
    dpi         = 600,
    units       = "in",
    device      = "jpeg"
  )
} else {
  cli::cli_alert_info(
    c(
      "Skipping saving of {.file cmtx_boxplot_sm} ",
      "because exists ",
      "and/or overwrite is set {.var FALSE}"
    )
  )
}

rm(sv_arg)
```

# 6.0 ---- Perform Kruskal-Wallis and Dunn Test ----
## 6.1 K-W Test with PFT on season

Here Kruskal-Wallis was performed to identify if there was any signficant 
difference between each season and a PFT.

If p-value <= 0.05, then would go to Dunn's test to test pairwise season-phyto 
combination.
```{r kruskal-and-dunn}
# concentration on season grouped by PFT
cmtx_kruskal <-
  cmtx_avgs %>% 
  group_by(phyto) %>% 
  kruskal_test(conc ~ season)

# extract PFT where p value > 0.05
p_gt_05 <- filter(cmtx_kruskal, p > 0.05)

# Dunn's test
cmtx_dunn <-
  cmtx_avgs %>%
  # remove PFT with no signficant difference
  filter(!(phyto %in% p_gt_05$phyto)) %>%
  group_by(phyto) %>%
  dunn_test(
    conc ~ season, 
    p.adjust.method = "bonferroni"
    ) 

cmtx_kruskal
p_gt_05
cmtx_dunn %>%
  filter(p.adj <= 0.05) %>% 
  unite("groups", group1, group2, sep = "-") 

```
Based on the results, Diatom 1 did not have any signficant difference between 
each season. 

From the pairwise Dunn's test, only 30 pairs were signficantly different.

# 7.0 ---- Combine PFT Sub Groups ----

i.e. diatom 1 + diatom 2 = diatom
```{r station-seasonally-yearly-avgs}
cmtx_avgs_w <-
  cmtx_avgs_w %>%
  # combine group into main group
  mutate(
    diat  = diat1 + diat2,
    cyano = cyano2 + cyano4,
    hapt  = hapt6 + hapt8,
    total = chloro + crypto + diat + dino + hapt + pras + cyano
  )
```


## 7.1  Stations 10, 16, WS: Plot Cyano and Diat vs time and 


```{r cmtx-summary}
# cmtx_season_avgs <-
cmtx_avgs_w %>%
  group_by(season) %>%
  summarise(
    across(
      chloro:hapt,
      list(
        avg = (\(x) mean(x, na.rm = TRUE)),
        sd  = (\(x) sd(x, na.rm = TRUE)),
        var = (\(x) var(x, na.rm = TRUE))
      )
    )
  )
```


## 7.2 Plot: Calculate Fraction and Plot 3 Stations with 2 PFTs (Diatom and Cyano)

Stations:
- 10
- 16
- WS

PFT:
- cyanobacteria (cyano2 and cyano4)
- diatom (diat1 and diat2)

Shows opposing signals where lower diatoms shows increase in cyano relatively

Issue is this doesn't show abosolute, where cyano could have incrased thus the
ratio is farther off.

```{r plt-cyano-diat, fig.height=8, fig.width=16}
cmtx_fract <-
    cmtx_avgs_w  %>%
    mutate(
        .keep = "none",
        date_time_utc, year, season, station,
        across(1:season),
        across(
            c(pras:hapt, chloro, crypto, dino), 
            (\(x) x/ total),
           .names = "frac_{.col}")
        ) 

cmtx_sub_ln_plt <- 
  cmtx_fract %>%
  pivot_longer(
    contains("frac"),
    names_to     = "phyto",
    values_to    = "frac",
    names_prefix = "frac_"
  ) %>%
  # add long names
  left_join(phyto_name, by = c("phyto" = "shrt")) %>%
    
  # filter for 2 PFTs and 3 stations
  filter(phyto %in% c("diat", "cyano")) %>%
  filter(station %in% c("WS", "10", "16")) %>%
  
  # plot
  ggplot(aes(
    x     = lubridate::ymd_hms(date_time_utc),
    y     = frac,
    color = names,
    fill  = names
  )) +
  geom_point() +
  geom_line() +
  
  labs(
    x     = NULL,
    # y     = "Proportion to Total Chl-a",
    y     = "PFT:Total Chlorophyll-a (%)",
    color = "Functional Type",
    fill  = "Functional Type"
  ) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1),
                     expand = c(0,0),
                     limits = c(0,1)) +
  facet_wrap(facets = "station") +
  theme_classic() +
  theme(
    text            = element_text(family = "serif", size = 40),
    axis.text       = element_text(size = 30),
    axis.text.x     = element_text(angle = 45, hjust = 1), 
    axis.ticks.length.x = unit(10, "pt"),
    legend.position = c(0.5, 0.8),
    panel.spacing = unit(20, "pt") 
  )

cmtx_sub_ln_plt
```


## 7.3 Save Subset of PFT and Stations


```{r save-dia-cyano}
sv_arg <-
  list(
    sv_loc    = dir_plt_save,
    sv_nm     = "phyto_bloom",
    overwrite = TRUE
  ) %>%
  c(
    .,
    phyto_bl = dir_ls(.$sv_loc, regexp = .$sv_nm) %>% is_empty()
  )

if (sv_arg$phyto_bl | sv_arg$overwrite) {
    save_plot(
        filename    = here(sv_arg$sv_loc, glue(sv_arg$sv_nm, ".jpeg")), 
        plot        = cmtx_sub_ln_plt,
        base_height = 8,
        base_width  = 16,
        dpi         = 600, 
        units       = "in", 
        device      = "jpeg")
} else {
   cli_alert_info(c("Skipping saving of {.file phyto_bloom} ",
                    "because exists ",
                    "and/or overwrite is set {.var FALSE}"))
}

rm(sv_arg)
```


# 8.0 ---- Average of Season and Stations per PFT ----


```{r view-avgs}
# by season
cmtx_fract %>%
  select(season, contains("frac")) %>%
  summarise(
    .by = season,
    across(
      .cols  = contains("frac"),
      .fns   = (\(x) mean(x, na.rm = TRUE)),
      .names = "{.col}_avg"
    )
  ) # %>%
# View(title = "phyto_avg_by_season")

# by station
cmtx_fract %>%
  mutate(station = fct_reorder(station, lon)) %>%
  group_by(station) %>%
  summarise(
    across(
      .cols  = contains("frac"),
      .fns   = (\(x) mean(x, na.rm = TRUE)),
      .names = "{.col}_avg"
    )
  ) # %>%
    # View(title = "phyto_avg_by_station") 
```


# 9.0 ---- PFT Fractions Plot ----


```{r config-frac}
cmtx_fract_long <-
  cmtx_fract %>%
  group_by(season) %>%
  summarise(
    across(
      .cols = contains("frac"),
      .fns  = mean,
    )
  ) %>%
  pivot_longer(
    contains("frac"),
    names_to     = "phyto",
    names_prefix = "frac_",
    values_to    = "avg_frac"
  ) %>%
  mutate(
    phyto = str_remove(phyto, "_avg")
  ) %>%
  left_join(phyto_name, 
            by = join_by("phyto" == "shrt"))

cmtx_fract_long
```


## 8.1 Plot: Seasonal Fraction of each PFT (Bar)


```{r plt-fracs, fig.width=20, fig.height=10}
# alternate color palette
# tol_muted <- c('#88CCEE', '#44AA99', '#117733', '#332288', '#DDCC77', '#999933',
#                '#CC6677', '#882255', '#AA4499')

tol_muted <- khroma::color("muted", names = FALSE)(9)


cmtx_szn_bar <-
  cmtx_fract_long %>%
  ggplot(
    aes(
      fill  = names,
      color = names,
      y     = avg_frac,
      x     = season
    )
  ) +
  geom_bar(
    position = "fill",
    stat     = "identity"
  ) +
  labs(
    x     = "Season",
    # y     = "Proportion to Total Chl-a",
    y     = "PFT:Total Chlorophyll-a (%)",
    fill  = "Phytoplankton Functional Type",
    color = "Phytoplankton Functional Type"
  ) +
  scale_fill_manual(values  = tol_muted) +
  scale_color_manual(values = tol_muted) +
    scale_y_continuous(
        labels = scales::percent_format(accuracy = 1),
        expand = c(0,0),
        limits = c(0,1)) +
  # theme
  theme_classic() +
  theme(
    text             = element_text(family = "serif", size = 20),
    axis.title       = element_text(size = 20),
    legend.position  = "bottom",
    legend.direction = "horizontal",
    plot.margin = margin(15,10,10,10, "pt")
  )

cmtx_szn_bar      
```


## Save seasonal faction of each PFT


```{r save-season-frac}
sv_arg <-
  list(
    sv_loc    = dir_plt_save,
    sv_nm     = "pft_prcnt_season",
    overwrite = FALSE
  ) %>%
  c(
    .,
    phyto_bl = dir_ls(.$sv_loc,
                      regexp = .$sv_nm) %>%
               is_empty()
  )

if (sv_arg$phyto_bl | sv_arg$overwrite) {
    save_plot( 
    filename = here(
     sv_arg$sv_loc,
     glue(
       sv_arg$sv_nm,
       format(Sys.time(), "_%Y%m%d_%H%M%S"),
       ".jpeg"
     )
   ),
   plot        = cmtx_szn_bar,
   base_height = 8,
   base_width  = 16,
   dpi         = 600,
   units       = "in",
   device      = "jpeg"
 )
} else {
    cli_alert_info(
        c(
          "Skipping saving of ",
          "{.file phyto_func_type_bar_ratio_reason} ",
          "because exists ",
          "and/or overwrite is set {.var FALSE}"
        )
    )
}

rm(sv_arg)
```


# TODO: test table of PFT proportions


```{r}
shelf(gt)
gt_pft <-
  cmtx_fract %>%
  summarise(
    .by = season,
    across(
      contains("frac"),
      list(
        avg = \(x) mean(x)
        # sd = \(x) sd(x)
      )
    )
  ) %>%
  gt(
    data = .,
    rowname_col = NULL,
    groupname_col = NULL
  ) %>%
  cols_label(
    frac_chloro_avg = "Chloro",
    frac_crypto_avg = "Crypto",
    frac_cyano_avg  = "Cyano",
    frac_diat_avg   = "Diat",
    frac_dino_avg   = "Dino",
    frac_hapt_avg   = "Hapt",
    frac_pras_avg   = "Pras"
  ) %>%
  tab_options(
    table_body.hlines.width = 0,
    table_body.vlines.width = 0,
    stub.border.width = 0
  ) %>%
  # fmt_number(columns = starts_with("frac"), decimals = 4) %>%
  fmt_percent(columns = starts_with("frac"), decimals = 0) %>%
  tab_spanner(
    label = "Average Fraction",
    columns = frac_chloro_avg:frac_pras_avg
  ) %>%
  tab_stubhead("Season") %>%
  opt_table_font("serif") %T>%
  print()


if (FALSE) {
  gtsave(
    gt_pft,
    filename = here(
      "data", "plots",
      glue(
        "community_fractions",
        format(Sys.time(), "_%Y%m%d_%H%M%S"),
        ".docx"
      )
    )
  )
}
```

